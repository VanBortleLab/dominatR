<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Triangle (ternary) dominance plot — plot_triangle • dominatR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Triangle (ternary) dominance plot — plot_triangle"><meta name="description" content="Creates a triangular (ternary) scatter plot for **three** numeric variables
Each point is coloured by the variable with the largest value and can be
filtered by (i) Entropy score ranging from (0 to 1.585) and
(ii) overall score
The plot is useful for visualising “winner-takes-all” behaviour in three-way
comparisons, e.g. gene expression in *A*, *B*, *C* conditions."><meta property="og:description" content="Creates a triangular (ternary) scatter plot for **three** numeric variables
Each point is coloured by the variable with the largest value and can be
filtered by (i) Entropy score ranging from (0 to 1.585) and
(ii) overall score
The plot is useful for visualising “winner-takes-all” behaviour in three-way
comparisons, e.g. gene expression in *A*, *B*, *C* conditions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dominatR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dominatR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Calculating-Entropy-and-Center-of-Mass.html">Calculating Entropy and Center of Mass</a></li>
    <li><a class="dropdown-item" href="../articles/Dominance-plot-in-2-to-N-dimensions.html">Dominance plot in 2 to N dimensions</a></li>
    <li><a class="dropdown-item" href="../articles/Normalization-Functions.html">Normalization Functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/VanBortleLab/dominatR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Triangle (ternary) dominance plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/VanBortleLab/dominatR/blob/main/R/plot_triangle.R" class="external-link"><code>R/plot_triangle.R</code></a></small>
      <div class="d-none name"><code>plot_Triangle.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a triangular (ternary) scatter plot for **three** numeric variables
Each point is coloured by the variable with the largest value and can be
filtered by (i) Entropy score ranging from (0 to 1.585) and
(ii) overall score</p>
<p>The plot is useful for visualising “winner-takes-all” behaviour in three-way
comparisons, e.g. gene expression in *A*, *B*, *C* conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_triangle</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  column_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span><span class="op">)</span>,</span>
<span>  background_col <span class="op">=</span> <span class="st">"whitesmoke"</span>,</span>
<span>  output_table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotAll <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  push_text <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric <code>data.frame</code>/<code>matrix</code> **or**
a <code>SummarizedExperiment</code>.</p></dd>


<dt id="arg-column-name">column_name<a class="anchor" aria-label="anchor" href="#arg-column-name"></a></dt>
<dd><p>Character. Names (or indices) of the three columns to
visualise. If <code>NULL</code>, the first three numeric columns are used.</p></dd>


<dt id="arg-entropyrange">entropyrange<a class="anchor" aria-label="anchor" href="#arg-entropyrange"></a></dt>
<dd><p>Numeric. Keep points whose entropy lies inside
this interval. Default is <code>c(0,Inf)</code></p></dd>


<dt id="arg-maxvaluerange">maxvaluerange<a class="anchor" aria-label="anchor" href="#arg-maxvaluerange"></a></dt>
<dd><p>Numeric. Keep points whose values lies inside
this interval. Default is <code>c(0,Inf)</code></p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>Character. Colors for each variable.</p></dd>


<dt id="arg-background-col">background_col<a class="anchor" aria-label="anchor" href="#arg-background-col"></a></dt>
<dd><p>Character. Color for the observations outside
<code>entropyrange</code> and <code>maxvaluerange</code></p></dd>


<dt id="arg-output-table">output_table<a class="anchor" aria-label="anchor" href="#arg-output-table"></a></dt>
<dd><p>Logical. If <code>TRUE</code> returns the processed data frame.</p></dd>


<dt id="arg-plotall">plotAll<a class="anchor" aria-label="anchor" href="#arg-plotall"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, filtered points are shown in
<code>background_col</code>; if <code>FALSE</code>, they are omitted.</p></dd>


<dt id="arg-cex-pch">cex, pch<a class="anchor" aria-label="anchor" href="#arg-cex-pch"></a></dt>
<dd><p>Base-graphics point size / symbol.</p></dd>


<dt id="arg-assay-name">assay_name<a class="anchor" aria-label="anchor" href="#arg-assay-name"></a></dt>
<dd><p>(SummarizedExperiment only) Which assay to use. Default:
the first assay.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, label the vertices of the triangle</p></dd>


<dt id="arg-push-text">push_text<a class="anchor" aria-label="anchor" href="#arg-push-text"></a></dt>
<dd><p>Numeric. Expands or contracts text label positions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>output_table = TRUE</code>, a <code>data.frame</code> with the original three
columns plus:</p><ul><li><p><code>comx</code>, <code>comy</code>  — Cartesian coordinates in the triangle;</p></li>
<li><p><code>color</code>              — final plotting colour;</p></li>
<li><p><code>entropy</code>            — Entropy scores for each gene;</p></li>
<li><p><code>max_counts</code>         — Maximum score across variables</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function expects three numeric columns. If the experiment has more than
three columns, the name of the columns of interest can be specified by using
 the parameter <code>column_name</code>. If <code>x</code> is
 a <code>SummarizedExperiment</code>, it extracts the indicated assay and extracts
  the columns of interest</p>
<p>It also uses:
  - <code><a href="centmass.html">centmass()</a></code> for computing <code>comx</code> and <code>comy</code>.
  - <code><a href="entropy.html">entropy()</a></code> for computing Shannon entropy, stored in the
    <code>entropy</code> column.  Between three variables, entropy rangeS between
    0 and 1.585.</p>
<p>The ternary vertices are fixed at
\(( \sin(0),  \cos(0) )\),
\(( \sin(2\pi/3),  \cos(2\pi/3) )\) and
\(( \sin(4\pi/3),  \cos(4\pi/3) )\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'airway'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">airway</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only use a random subset of 1000 rows</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Normalize the data first using tpm_normalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">gene_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">gene_seq_end</span> <span class="op">-</span></span></span>
<span class="r-in"><span>                           <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">gene_seq_start</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="tpm_normalization.html">tpm_normalization</a></span><span class="op">(</span><span class="va">se</span>, log_trans <span class="op">=</span> <span class="cn">TRUE</span>, new_assay_name <span class="op">=</span> <span class="st">'tpm_norm'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># 1) Using a data.frame</span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">'tpm_norm'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Choose three columns of interest, in this case 'SRR1039508', 'SRR1039516'</span></span></span>
<span class="r-in"><span><span class="co"># and 'SRR1039512'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default Behaviour</span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colors can be modified</span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Emphasis can be applied to highly dominant variables by controling</span></span></span>
<span class="r-in"><span><span class="co"># entropy parameter,</span></span></span>
<span class="r-in"><span><span class="co"># values outside of that range will be colored smokewhite.</span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Points in the center are a reflection of genes with expression levels = 0.</span></span></span>
<span class="r-in"><span><span class="co"># This can be modified by adjusting the maxvalue range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By controling entropy range, you can observe different types of genes.</span></span></span>
<span class="r-in"><span><span class="co"># Values closer to 0 represent dominance and closer to 1.6 shareness.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same analysis can be performed by filtering out genes with low expression</span></span></span>
<span class="r-in"><span><span class="co"># values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Background points can be removed</span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'indianred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              plotAll <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># -------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># 1) Using a SummarizedExperiment</span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'darkred'</span>, <span class="st">'darkgreen'</span>, <span class="st">'darkblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              assay_name <span class="op">=</span> <span class="st">'tpm_norm'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'darkred'</span>, <span class="st">'darkgreen'</span>, <span class="st">'darkblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              assay_name <span class="op">=</span> <span class="st">'tpm_norm'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>              column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>, <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'darkred'</span>, <span class="st">'darkgreen'</span>, <span class="st">'darkblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              assay_name <span class="op">=</span> <span class="st">'tpm_norm'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_Triangle-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Obtaining the DF output for the analysis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">=</span> <span class="fu">plot_triangle</span><span class="op">(</span>x <span class="op">=</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>                       column_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRR1039508"</span>, <span class="st">"SRR1039516"</span>,</span></span>
<span class="r-in"><span>                       <span class="st">'SRR1039512'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       output_table <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'darkred'</span>, <span class="st">'darkgreen'</span>, <span class="st">'darkblue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       entropyrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       maxvaluerange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       assay_name <span class="op">=</span> <span class="st">'tpm_norm'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 max_counts          comx        comy         a         b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000260166   0.000000  0.0000000000 0.000000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000266931   0.000000  0.0000000000 0.000000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000104774  10.691031 -0.0009644106 0.004970639 0.3366471 0.3311197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000267583   0.000000  0.0000000000 0.000000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000227581   4.845949  0.0000000000 1.000000000 1.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000227317   0.000000  0.0000000000 0.000000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         c  Entropy      color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000260166 0.0000000 0.000000 whitesmoke</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000266931 0.0000000 0.000000 whitesmoke</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000104774 0.3322333 1.584926    darkred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000267583 0.0000000 0.000000 whitesmoke</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000227581 0.0000000 0.000000 whitesmoke</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ENSG00000227317 0.0000000 0.000000 whitesmoke</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Lizarazo, Ethan Chen, Rajendra K C, Kevin Van Bortle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

