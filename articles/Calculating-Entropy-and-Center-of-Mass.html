<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculating Entropy and Center of Mass ‚Ä¢ dominatR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating Entropy and Center of Mass">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dominatR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/dominatR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Calculating-Entropy-and-Center-of-Mass.html">Calculating Entropy and Center of Mass</a></li>
    <li><a class="dropdown-item" href="../articles/Dominance-plot-in-2-to-N-dimensions.html">Dominance plot in 2 to N dimensions</a></li>
    <li><a class="dropdown-item" href="../articles/Normalization-Functions.html">Normalization Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/VanBortleLab/dominatR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculating Entropy and Center of Mass</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VanBortleLab/dominatR/blob/main/vignettes/articles/Calculating-Entropy-and-Center-of-Mass.Rmd" class="external-link"><code>vignettes/articles/Calculating-Entropy-and-Center-of-Mass.Rmd</code></a></small>
      <div class="d-none name"><code>Calculating-Entropy-and-Center-of-Mass.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/VanBortleLab/dominatR" class="external-link">dominatR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/VanBortleLab/dominatRData" class="external-link">dominatRData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The data used in this article comes from two different sources:</p>
<ol style="list-style-type: decimal">
<li>A <code>SummarizedExperiment</code> object from the library
<code>airway</code>
</li>
<li>A <code>data.frame</code> retrieved from the supplementary library
<code>dominatRData</code>
</li>
</ol>
<p>The purpose of using two different sources is meant to show the
capacity of dominatR to process different objects.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### summarized experiment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"airway"</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span><span class="va">airway</span></span>
<span></span>
<span><span class="co"># Only use a random subset of 500 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"rnapol_score"</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">=</span> <span class="va">rnapol_score</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"atac_tissue_score"</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">=</span> <span class="va">atac_tissue_score</span></span></code></pre></div>
<p>In the context of information theory, <strong>entropy (Shannon
Entropy)</strong> is a metric used to measure the uncertainty associated
with a set of variables. It‚Äôs value ranges from 0 to ùëôùëúùëî(ùëÅ), where N is
the total number of variables accounted for. Its interpretation is
straightforward:</p>
<ol style="list-style-type: decimal">
<li><p>An observation with high entropy values is not uncertain, that
observation is expected to occur at a high probability level, across all
the variables. For example, Gene A if it is expressed in all the
variables at the same levels will have a high entropy value.</p></li>
<li><p>An observation with low entropy values is uncertain, that
observation is expected to occur at a high probability level, only in a
set of few variables. For example, Gene B if it is expressed only in
variable A or variable B and not in the rest of tissues will have a low
entropy value.</p></li>
</ol>
<p>Entropy is calculated by using the following formula:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>‚àí</mo><mo>‚àë</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(X) = -‚àë p(x) * log2(p(x))</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math>
is equal to the relative levels of a gene (g) in a specific variable
(t). From this formula, it is possible to measure the categorical tissue
specificity that is defined as:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>=</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q_{(g|t)} = H(X) - log2(p(x))</annotation></semantics></math></p>
<p>This formula specifies a ‚Äòdomination‚Äô value for a specific gene in a
specific tissue. Therefore low values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">Q_{(g|t)}</annotation></semantics></math>
occurs when a gene or observation is mostly present in a small subset of
tissues.</p>
<p>In physics, <strong>center of mass</strong> is a way to summarize how
a quantity (typically mass) is distributed across space. It represents
the unique point where the weighted average of all positions, relative
to their associated weights, balances out. For weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w_i \ge 0</annotation></semantics></math>
at coordinates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">{r}_i</annotation></semantics></math>‚Äã,
the CoM is</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>M</mi><mo>=</mo><mfrac><mrow><msub><mo>‚àë</mo><mi>i</mi></msub><mi>‚Äã</mi><msub><mi>w</mi><mi>i</mi></msub><mi>‚Äã</mi><msub><mi>r</mi><mi>i</mi></msub></mrow><mrow><msub><mo>‚àë</mo><mi>i</mi></msub><mi>‚Äã</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><mi>‚Äã</mi><mi>‚Äã</mi><mi>‚Äã</mi></mrow><annotation encoding="application/x-tex">CoM=\frac{‚àë_i‚Äãw_i‚Äãr_i}{‚àë_i‚Äãw_i}‚Äã‚Äã‚Äã</annotation></semantics></math>.</p>
<p>For the context of this package, the weights are sample-level
measurements (e.g gene expression) and the positions are user defined
coordinates assigned to samples (For up to three dimensions). CoM
summarizes where the observation is positioned in the coordinate system.
Its interpretation is as follows:</p>
<ol style="list-style-type: decimal">
<li>An observation that is dominated by one sample, will be located near
that sample‚Äôs coordinate.</li>
<li>An observation that is uniformly distributed across samples, will be
located near the geometric center of all sample coordinates.</li>
</ol>
<p>The package provides formulas that are useful to calculate the
Entropy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(X)</annotation></semantics></math>,
‚ÄòCategorical‚Äô Entropy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">Q_{(g|t)}</annotation></semantics></math>
and Center of Mass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">CoM</annotation></semantics></math>:</p>
<ul>
<li><p><code><a href="../reference/entropy.html">entropy()</a></code></p></li>
<li><p><code><a href="../reference/Qentropy.html">Qentropy()</a></code></p></li>
<li><p><code><a href="../reference/centmass.html">centmass()</a></code><br></p></li>
</ul>
<div class="section level3">
<h3 id="center-of-mass">Center of Mass<a class="anchor" aria-label="anchor" href="#center-of-mass"></a>
</h3>
<p>Center of mass is useful when using no more than 3 dimensions given
that more than 3 dimensions are not representable in a bidimensional
plane. The function requires specification of a set of coordinates, by
default, the function uses <code>x_coord = c(0, 1, 0.5)</code> and
<code>y_coord = c(0, 0, sqrt(3)/2)</code>, which correspond to an
equilateral triangle. The function returns the pair of coordinates x and
y for each observation representing the spatial location of the CoM as a
data frame or as extra columns in <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData()</a></code> is a
SummarizedExperiment is used.</p>
<div class="section level4">
<h4 id="example-1-a-data-frame">Example 1: A data.frame<a class="anchor" aria-label="anchor" href="#example-1-a-data-frame"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="va">df1</span></span>
<span><span class="co">## calculating center of mass in the numerical functions</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/centmass.html">centmass</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;        comx       comy</span></span>
<span><span class="co">#&gt; 1 0.1022727 0.05248639</span></span>
<span><span class="co">#&gt; 2 0.4998737 0.86580669</span></span>
<span><span class="co">#&gt; 3 0.1439394 0.00000000</span></span>
<span><span class="co">#&gt; 4 0.5002817 0.86510373</span></span>
<span><span class="co">#&gt; 5 0.4962568 0.85851978</span></span>
<span><span class="co">#&gt; 6 0.4982841 0.85948712</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-2-a-summarized-experiment">Example 2: A summarized Experiment<a class="anchor" aria-label="anchor" href="#example-2-a-summarized-experiment"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting 3 columns</span></span>
<span><span class="va">se2</span> <span class="op">=</span> <span class="va">se</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centmass.html">centmass</a></span><span class="op">(</span><span class="va">se2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 12 columns</span></span>
<span><span class="co">#&gt;                         gene_id      gene_name  entrezid   gene_biotype</span></span>
<span><span class="co">#&gt;                     &lt;character&gt;    &lt;character&gt; &lt;integer&gt;    &lt;character&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166 ENSG00000260166  RP11-863P13.6        NA        lincRNA</span></span>
<span><span class="co">#&gt; ENSG00000266931 ENSG00000266931 RP11-1252D15.1        NA     pseudogene</span></span>
<span><span class="co">#&gt; ENSG00000104774 ENSG00000104774         MAN2B1        NA protein_coding</span></span>
<span><span class="co">#&gt; ENSG00000267583 ENSG00000267583  RP11-322E11.5        NA        lincRNA</span></span>
<span><span class="co">#&gt; ENSG00000227581 ENSG00000227581   RP13-140E4.1        NA     pseudogene</span></span>
<span><span class="co">#&gt; ENSG00000227317 ENSG00000227317          DDAH2        NA protein_coding</span></span>
<span><span class="co">#&gt;                 gene_seq_start gene_seq_end       seq_name seq_strand</span></span>
<span><span class="co">#&gt;                      &lt;integer&gt;    &lt;integer&gt;    &lt;character&gt;  &lt;integer&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166       88120993     88121538             16          1</span></span>
<span><span class="co">#&gt; ENSG00000266931       87282781     87282923              2         -1</span></span>
<span><span class="co">#&gt; ENSG00000104774       12757325     12777556             19         -1</span></span>
<span><span class="co">#&gt; ENSG00000267583       33023833     33047052             18         -1</span></span>
<span><span class="co">#&gt; ENSG00000227581       89294212     89294833              X         -1</span></span>
<span><span class="co">#&gt; ENSG00000227317       31676987     31680566 HSCHR6_MHC_DBB         -1</span></span>
<span><span class="co">#&gt;                 seq_coord_system         symbol      comx      comy</span></span>
<span><span class="co">#&gt;                        &lt;integer&gt;    &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166               NA  RP11-863P13.6  0.000000  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000266931               NA RP11-1252D15.1  0.000000  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000104774               NA         MAN2B1  0.497312  0.323613</span></span>
<span><span class="co">#&gt; ENSG00000267583               NA  RP11-322E11.5  1.000000  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000227581               NA   RP13-140E4.1  0.000000  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000227317               NA          DDAH2  0.000000  0.000000</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="entropy">Entropy<a class="anchor" aria-label="anchor" href="#entropy"></a>
</h3>
<p>Entropy offers the benefit of calculating the levels of surprise of
an observation across N-Variables. The function transforms a data frame
into proportions and adds a column with the name Entropy. Nevertheless,
if using a <code>SummarizedExperiment</code> object, there is an option
for the user to store the proportions in a new assay and adds a column
with the name Entropy in the <code>rowdata()</code>.</p>
<div class="section level4">
<h4 id="example-1-a-data-frame-1">Example 1: A data.frame<a class="anchor" aria-label="anchor" href="#example-1-a-data-frame-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="va">df1</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/entropy.html">entropy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Chr     Start      Stop RNA_type         pol1         pol2         pol3</span></span>
<span><span class="co">#&gt; 1 chr1 0.4999965 0.5000034     tRNA 7.835873e-08 6.501380e-09 5.474846e-09</span></span>
<span><span class="co">#&gt; 2 chr1 0.4999952 0.5000012     tRNA 9.079536e-10 0.000000e+00 3.594286e-06</span></span>
<span><span class="co">#&gt; 3 chr1 0.4999970 0.5000030     tRNA 3.417090e-08 5.745550e-09 0.000000e+00</span></span>
<span><span class="co">#&gt; 4 chr1 0.4999921 0.4999982     tRNA 2.419044e-09 7.861892e-09 9.649868e-06</span></span>
<span><span class="co">#&gt; 5 chr1 0.4999921 0.4999982     tRNA 7.856825e-08 5.741526e-09 9.643649e-06</span></span>
<span><span class="co">#&gt; 6 chr1 0.4999959 0.5000019     tRNA 1.208625e-08 4.532346e-09 2.184591e-06</span></span>
<span><span class="co">#&gt;    Entropy</span></span>
<span><span class="co">#&gt; 1 1.000002</span></span>
<span><span class="co">#&gt; 2 1.000067</span></span>
<span><span class="co">#&gt; 3 1.000001</span></span>
<span><span class="co">#&gt; 4 1.000165</span></span>
<span><span class="co">#&gt; 5 1.000167</span></span>
<span><span class="co">#&gt; 6 1.000042</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-2-a-summarized-experiment-1">Example 2: A summarized Experiment<a class="anchor" aria-label="anchor" href="#example-2-a-summarized-experiment-1"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting 3 columns</span></span>
<span><span class="va">se2</span> <span class="op">=</span> <span class="va">se</span></span>
<span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/entropy.html">entropy</a></span><span class="op">(</span><span class="va">se2</span>, new_assay_name <span class="op">=</span> <span class="st">'Entropy'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 11 columns</span></span>
<span><span class="co">#&gt;                         gene_id      gene_name  entrezid   gene_biotype</span></span>
<span><span class="co">#&gt;                     &lt;character&gt;    &lt;character&gt; &lt;integer&gt;    &lt;character&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166 ENSG00000260166  RP11-863P13.6        NA        lincRNA</span></span>
<span><span class="co">#&gt; ENSG00000266931 ENSG00000266931 RP11-1252D15.1        NA     pseudogene</span></span>
<span><span class="co">#&gt; ENSG00000104774 ENSG00000104774         MAN2B1        NA protein_coding</span></span>
<span><span class="co">#&gt; ENSG00000267583 ENSG00000267583  RP11-322E11.5        NA        lincRNA</span></span>
<span><span class="co">#&gt; ENSG00000227581 ENSG00000227581   RP13-140E4.1        NA     pseudogene</span></span>
<span><span class="co">#&gt; ENSG00000227317 ENSG00000227317          DDAH2        NA protein_coding</span></span>
<span><span class="co">#&gt;                 gene_seq_start gene_seq_end       seq_name seq_strand</span></span>
<span><span class="co">#&gt;                      &lt;integer&gt;    &lt;integer&gt;    &lt;character&gt;  &lt;integer&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166       88120993     88121538             16          1</span></span>
<span><span class="co">#&gt; ENSG00000266931       87282781     87282923              2         -1</span></span>
<span><span class="co">#&gt; ENSG00000104774       12757325     12777556             19         -1</span></span>
<span><span class="co">#&gt; ENSG00000267583       33023833     33047052             18         -1</span></span>
<span><span class="co">#&gt; ENSG00000227581       89294212     89294833              X         -1</span></span>
<span><span class="co">#&gt; ENSG00000227317       31676987     31680566 HSCHR6_MHC_DBB         -1</span></span>
<span><span class="co">#&gt;                 seq_coord_system         symbol   Entropy</span></span>
<span><span class="co">#&gt;                        &lt;integer&gt;    &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; ENSG00000260166               NA  RP11-863P13.6  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000266931               NA RP11-1252D15.1  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000104774               NA         MAN2B1  2.979167</span></span>
<span><span class="co">#&gt; ENSG00000267583               NA  RP11-322E11.5  0.000000</span></span>
<span><span class="co">#&gt; ENSG00000227581               NA   RP13-140E4.1  0.918296</span></span>
<span><span class="co">#&gt; ENSG00000227317               NA          DDAH2  0.000000</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="categorical-entropy">Categorical Entropy<a class="anchor" aria-label="anchor" href="#categorical-entropy"></a>
</h3>
<p>For calculating Categorical Entropy, it is required to compute first
Entropy in the dataset of interest. If the object is a dataframe, the
Entropy transformed dataframe will be subsequently transformed. If the
object is a SummarizedExperiment, the dataset can be stored in a new
assay.</p>
<div class="section level4">
<h4 id="example-1-a-data-frame-2">Example 1: A data.frame<a class="anchor" aria-label="anchor" href="#example-1-a-data-frame-2"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="va">df2</span> </span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/entropy.html">entropy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/Qentropy.html">Qentropy</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Heart</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core_type   Chr     Start       End</span></span>
<span><span class="co">#&gt; 9363    Specific  chr1 151022749 151022852</span></span>
<span><span class="co">#&gt; 1112    Specific  chr4 155464005 155465338</span></span>
<span><span class="co">#&gt; 2850    Specific  chr1 237945359 237946320</span></span>
<span><span class="co">#&gt; 8751    Specific chr19  45427468  45427615</span></span>
<span><span class="co">#&gt; 4324 25% Tissues  chr9  33657848  33659206</span></span>
<span><span class="co">#&gt; 9799 25% Tissues chr21   8253841   8255704</span></span>
<span><span class="co">#&gt;                                              Gene  Index     Type    Heart</span></span>
<span><span class="co">#&gt; 9363                 U6_snRNA_URS00006B5505&amp;&amp;9098   9098   u6 RNA 2.000000</span></span>
<span><span class="co">#&gt; 1112 LSU_rRNA_bacteria_rRNA_URS0000994EE4&amp;&amp;122489 122489 LSU rRNA 3.169925</span></span>
<span><span class="co">#&gt; 2850  SSU_rRNA_bacteria_rRNA_URS000096E89F&amp;&amp;14540  14540 SSU rRNA 4.000000</span></span>
<span><span class="co">#&gt; 8751     Metazoa_SRP_SRP_RNA_URS00009442C9&amp;&amp;78677  78677      SRP 4.643856</span></span>
<span><span class="co">#&gt; 4324 LSU_rRNA_bacteria_rRNA_URS00009A7234&amp;&amp;163885 163885 LSU rRNA 5.169925</span></span>
<span><span class="co">#&gt; 9799   SSU_rRNA_eukarya_rRNA_URS0000ABD7D5&amp;&amp;99559  99559 SSU rRNA 5.169925</span></span>
<span><span class="co">#&gt;      Spleen    Liver    Colon Adrenal.Gland Lung Pancreas Gallbladder</span></span>
<span><span class="co">#&gt; 9363    Inf      Inf      Inf           Inf  Inf      Inf         Inf</span></span>
<span><span class="co">#&gt; 1112    Inf 3.169925      Inf      3.169925  Inf      Inf         Inf</span></span>
<span><span class="co">#&gt; 2850    Inf      Inf 4.000000           Inf  Inf      Inf         Inf</span></span>
<span><span class="co">#&gt; 8751    Inf      Inf      Inf           Inf  Inf      Inf         Inf</span></span>
<span><span class="co">#&gt; 4324    Inf      Inf 5.169925      5.169925  Inf      Inf         Inf</span></span>
<span><span class="co">#&gt; 9799    Inf      Inf      Inf           Inf  Inf 5.169925         Inf</span></span>
<span><span class="co">#&gt;      Urinary.Tract   Breast Fallopian.Tube Psoas.Muscle Vena.Cava</span></span>
<span><span class="co">#&gt; 9363           Inf      Inf            Inf     2.000000       Inf</span></span>
<span><span class="co">#&gt; 1112           Inf      Inf            Inf          Inf       Inf</span></span>
<span><span class="co">#&gt; 2850           Inf 4.000000            Inf          Inf       Inf</span></span>
<span><span class="co">#&gt; 8751           Inf      Inf            Inf          Inf  4.643856</span></span>
<span><span class="co">#&gt; 4324      5.169925 5.169925            Inf          Inf       Inf</span></span>
<span><span class="co">#&gt; 9799           Inf      Inf            Inf     5.169925  5.169925</span></span>
<span><span class="co">#&gt;      Gastroesophageal.Sphincter Adipose.Tissue Sciatic.Nerve Ovary...Uterus</span></span>
<span><span class="co">#&gt; 9363                        Inf            Inf           Inf            Inf</span></span>
<span><span class="co">#&gt; 1112                        Inf            Inf           Inf            Inf</span></span>
<span><span class="co">#&gt; 2850                        Inf            Inf           Inf            Inf</span></span>
<span><span class="co">#&gt; 8751                        Inf       4.643856      4.643856       4.643856</span></span>
<span><span class="co">#&gt; 4324                        Inf       5.169925           Inf            Inf</span></span>
<span><span class="co">#&gt; 9799                        Inf            Inf      5.169925            Inf</span></span>
<span><span class="co">#&gt;      Stomach    Brain</span></span>
<span><span class="co">#&gt; 9363     Inf      Inf</span></span>
<span><span class="co">#&gt; 1112     Inf      Inf</span></span>
<span><span class="co">#&gt; 2850       4      Inf</span></span>
<span><span class="co">#&gt; 8751     Inf      Inf</span></span>
<span><span class="co">#&gt; 4324     Inf      Inf</span></span>
<span><span class="co">#&gt; 9799     Inf 5.169925</span></span></code></pre></div>
<p>From this dataframe, it is possible to see how the observations
<code>gene_9363</code>, <code>gene_1112</code>, <code>gene_2850</code>
have low values of Qentropy emphasizing high score or normalized
features in <code>Heart</code> when compared to the other samples.</p>
</div>
<div class="section level4">
<h4 id="example-2-a-summarized-experiment-2">Example 2: A summarized Experiment<a class="anchor" aria-label="anchor" href="#example-2-a-summarized-experiment-2"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subsetting 3 columns</span></span>
<span><span class="va">se2</span> <span class="op">=</span> <span class="va">se</span></span>
<span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/entropy.html">entropy</a></span><span class="op">(</span><span class="va">se2</span>, new_assay_name <span class="op">=</span> <span class="st">'Entropy'</span><span class="op">)</span></span>
<span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Qentropy.html">Qentropy</a></span><span class="op">(</span><span class="va">se2</span>, assay_name <span class="op">=</span> <span class="st">'Entropy'</span>, new_assay_name <span class="op">=</span> <span class="st">'Qentropy'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se2</span>, <span class="st">'Qentropy'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516</span></span>
<span><span class="co">#&gt; ENSG00000260166        Inf        Inf        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000266931        Inf        Inf        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000104774   5.954307   5.979072   5.711755   6.640587   6.005811</span></span>
<span><span class="co">#&gt; ENSG00000267583        Inf   0.000000        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000227581   2.503258        Inf        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000227317        Inf        Inf        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt;                 SRR1039517 SRR1039520 SRR1039521</span></span>
<span><span class="co">#&gt; ENSG00000260166        Inf   0.000000        Inf</span></span>
<span><span class="co">#&gt; ENSG00000266931        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000104774   5.732659   6.049651   5.941714</span></span>
<span><span class="co">#&gt; ENSG00000267583        Inf        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000227581   1.503258        Inf        Inf</span></span>
<span><span class="co">#&gt; ENSG00000227317        Inf        Inf        Inf</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h4>
<pre><code><span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] ggplot2_4.0.1               dominatRData_0.99.1        </span></span>
<span><span class="co">#&gt;  [3] airway_1.30.0               SummarizedExperiment_1.40.0</span></span>
<span><span class="co">#&gt;  [5] Biobase_2.70.0              GenomicRanges_1.62.0       </span></span>
<span><span class="co">#&gt;  [7] Seqinfo_1.0.0               IRanges_2.44.0             </span></span>
<span><span class="co">#&gt;  [9] S4Vectors_0.48.0            BiocGenerics_0.56.0        </span></span>
<span><span class="co">#&gt; [11] generics_0.1.4              MatrixGenerics_1.22.0      </span></span>
<span><span class="co">#&gt; [13] matrixStats_1.5.0           dominatR_0.99.5            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10         SparseArray_1.10.1  lattice_0.22-7     </span></span>
<span><span class="co">#&gt;  [4] digest_0.6.38       magrittr_2.0.4      RColorBrewer_1.1-3 </span></span>
<span><span class="co">#&gt;  [7] evaluate_1.0.5      grid_4.5.2          fastmap_1.2.0      </span></span>
<span><span class="co">#&gt; [10] jsonlite_2.0.0      Matrix_1.7-4        ggnewscale_0.5.2   </span></span>
<span><span class="co">#&gt; [13] scales_1.4.0        tweenr_2.0.3        textshaping_1.0.4  </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4     abind_1.4-8         cli_3.6.5          </span></span>
<span><span class="co">#&gt; [19] rlang_1.1.6         polyclip_1.10-7     XVector_0.50.0     </span></span>
<span><span class="co">#&gt; [22] withr_3.0.2         cachem_1.1.0        DelayedArray_0.36.0</span></span>
<span><span class="co">#&gt; [25] yaml_2.3.10         S4Arrays_1.10.0     tools_4.5.2        </span></span>
<span><span class="co">#&gt; [28] dplyr_1.1.4         vctrs_0.6.5         R6_2.6.1           </span></span>
<span><span class="co">#&gt; [31] lifecycle_1.0.4     fs_1.6.6            MASS_7.3-65        </span></span>
<span><span class="co">#&gt; [34] ragg_1.5.0          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">#&gt; [37] pkgdown_2.2.0       bslib_0.9.0         pillar_1.11.1      </span></span>
<span><span class="co">#&gt; [40] gtable_0.3.6        glue_1.8.0          ggforce_0.5.0      </span></span>
<span><span class="co">#&gt; [43] systemfonts_1.3.1   xfun_0.54           tibble_3.3.0       </span></span>
<span><span class="co">#&gt; [46] tidyselect_1.2.1    knitr_1.50          farver_2.1.2       </span></span>
<span><span class="co">#&gt; [49] htmltools_0.5.8.1   rmarkdown_2.30      compiler_4.5.2     </span></span>
<span><span class="co">#&gt; [52] S7_0.2.1            geomtextpath_0.2.0</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Lizarazo, Ethan Chen, Rajendra K C, Kevin Van Bortle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
